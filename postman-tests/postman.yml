.newman:
  stage: postman-test
  tags: ["docker-runner"]
  image:
    name: postman/newman_alpine33
    entrypoint: [""]
  before_script:
    - apk add git
    - mkdir postman_test
    - cd postman_test
    - git clone https://gitlab-ci-token:${CI_JOB_TOKEN}@community.opengroup.org/osdu/platform/testing.git

  script:
    - newman --version
    - newman run "$COLLECTION_JSON" -e "$ENVIRONMENT" -d "$GCP_TEST_COLLECTION_CONFIG" --reporters cli

GCP-postman-tests:
  extends: .newman
  variables:
    ENVIRONMENT: "/builds/osdu/platform/system/storage/postman_test/testing/Postman Collection/00_CICD_Setup_Environment/gcp.OSDU R3 PROD v1.0.postman_environment.json"
    COLLECTION_JSON: "/builds/osdu/platform/system/storage/postman_test/testing/Postman Collection/12_CICD_Setup_StorageAPI/Storage API CI-CD v1.11.postman_collection.json"
    HTML_REPORT_NAME: "gcp.Storage API CI-CD v1_11_report_extra.html"
    JUNIT_REPORT_NAME: "gcp.Storage API CI-CD v1_11_report_junit.xml"

AWS-postman-tests:
  extends: .newman
  variables:
    ENVIRONMENT: "/builds/osdu/platform/testing/Postman Collection/00_CICD_Setup_Environment/gcp.OSDU R3 PROD v1.0.postman_environment.json"
    COLLECTION_JSON: "/builds/osdu/platform/testing/Postman Collection/12_CICD_Setup_StorageAPI/Storage API CI-CD v1.11.postman_collection.json"
    HTML_REPORT_NAME: "aws.Storage API CI-CD v1_11_report_extra.html"
    JUNIT_REPORT_NAME: "aws.Storage API CI-CD v1_11_report_junit.xml"

Azure-postman-tests:
  extends: .newman
  variables:
    ENVIRONMENT: "/builds/osdu/platform/testing/Postman Collection/00_CICD_Setup_Environment/gcp.OSDU R3 PROD v1.0.postman_environment.json"
    COLLECTION_JSON: "/builds/osdu/platform/testing/Postman Collection/12_CICD_Setup_StorageAPI/Storage API CI-CD v1.11.postman_collection.json"
    HTML_REPORT_NAME: "azure.Storage API CI-CD v1_11_report_extra.html"
    JUNIT_REPORT_NAME: "azure.Storage API CI-CD v1_11_report_junit.xml"